<!doctype html><html lang=en-us dir=ltr><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  Analogy with the Physical World
  #

Digital certificates are like identification documents (passport, identity
card, driver license, employee badge, library membership card, retail store
fidelity card, etc.), but for websites. They tie a name to an identity, they
hold additional metadata, they are issued by some (more or less widely
recognized/trusted) entity, and they can be used/accepted in specific
circumstances.
Digital certificates are issued by CAs (Certificate - or Certification -
Authorities). CAs can either be public or private. Certificates issued by
publicly trusted CAs are trusted/accepted by default by major web browsers and
operating systems (like government-issued passports). Certificate issued by
private CAs are only trusted/accepted by clients who agreed to trust them (like
retail store fidelity cards)."><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="http://localhost:1313/webpki/cert/"><meta property="og:site_name" content="ACME and the WebPKI"><meta property="og:title" content="Anatomy of a Certificate"><meta property="og:description" content="Analogy with the Physical World # Digital certificates are like identification documents (passport, identity card, driver license, employee badge, library membership card, retail store fidelity card, etc.), but for websites. They tie a name to an identity, they hold additional metadata, they are issued by some (more or less widely recognized/trusted) entity, and they can be used/accepted in specific circumstances.
Digital certificates are issued by CAs (Certificate - or Certification - Authorities). CAs can either be public or private. Certificates issued by publicly trusted CAs are trusted/accepted by default by major web browsers and operating systems (like government-issued passports). Certificate issued by private CAs are only trusted/accepted by clients who agreed to trust them (like retail store fidelity cards)."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="webpki"><title>Anatomy of a Certificate | ACME and the WebPKI</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=http://localhost:1313/webpki/cert/><link rel=stylesheet href=/book.min.e9f68c3fff3d8236a489d16a9caf6de5e4d1a29c20eb4b5524e42cd30be4d319.css integrity="sha256-6faMP/89gjakidFqnK9t5eTRopwg60tVJOQs0wvk0xk=" crossorigin=anonymous><script async src="https://www.googletagmanager.com/gtag/js?id=G-0LW86NH9LL"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-0LW86NH9LL")}</script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>ACME and the WebPKI</span></a></h2><ul><li><a href=/getting-started/>Getting Started with ACME</a></li><li><a href=/acme/>The ACME Protocol</a><ul><li><a href=/acme/overview/>Overview</a></li><li><a href=/acme/challenges/>Challenge Types</a></li><li><a href=/acme/eab/>EAB (External Account Binding)</a></li><li><a href=/acme/ari/>ARI (ACME Renewal Information)</a></li></ul></li><li><a href=/webpki/>The WebPKI</a><ul><li><a href=/webpki/cert/ class=active>Anatomy of a Certificate</a></li><li><a href=/webpki/cert-lifetime/>Certificate Lifetime</a></li><li><a href=/webpki/caa/>CAA (Certificate Authority Authorization)</a></li><li><a href=/webpki/mpic/>MPIC (Multi-Perspective Issuance Corroboration)</a></li><li><a href=/webpki/ct/>CT (Certificate Transparency)</a></li></ul></li></ul><ul><li><a href=https://github.com/fhchstr/acmeprotocol.dev target=_blank rel=noopener>Contribute to this Website</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>Anatomy of a Certificate</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#analogy-with-the-physical-world>Analogy with the Physical World</a></li><li><a href=#anatomy-of-a-certificate>Anatomy of a Certificate</a><ul><li><a href=#version>Version</a></li><li><a href=#serial-number>Serial Number</a></li><li><a href=#signature-algorithm>Signature Algorithm</a></li><li><a href=#issuer>Issuer</a></li><li><a href=#validity>Validity</a></li><li><a href=#subject>Subject</a></li><li><a href=#subject-public-key-info>Subject Public Key Info</a></li><li><a href=#extensions>Extensions</a><ul><li><a href=#key-usage>Key Usage</a></li><li><a href=#eku>Extended Key Usage</a></li><li><a href=#basic-constraints>Basic Constraints</a></li><li><a href=#subject-key-identifier>Subject Key Identifier</a></li><li><a href=#authority-key-identifier>Authority Key Identifier</a></li><li><a href=#aia>Authority Information Access</a></li><li><a href=#san>Subject Alternative Name</a></li><li><a href=#certificate-policies>Certificate Policies</a></li><li><a href=#crl-distribution-points>CRL Distribution Points</a></li><li><a href=#sct>CT Precertificate SCTs</a></li></ul></li></ul></li><li><a href=#encoding>Encoding</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=analogy-with-the-physical-world>Analogy with the Physical World
<a class=anchor href=#analogy-with-the-physical-world>#</a></h1><p><strong>Digital certificates are like identification documents</strong> (passport, identity
card, driver license, employee badge, library membership card, retail store
fidelity card, etc.), but for websites. They tie a name to an identity, they
hold additional metadata, they are issued by some (more or less widely
recognized/trusted) entity, and they can be used/accepted in specific
circumstances.</p><p>Digital certificates are issued by CAs (Certificate - or Certification -
Authorities). CAs can either be public or private. Certificates issued by
publicly trusted CAs are trusted/accepted by default by major web browsers and
operating systems (like government-issued passports). Certificate issued by
private CAs are only trusted/accepted by clients who agreed to trust them (like
retail store fidelity cards).</p><p>In the same way that an identification document attests that a person has the
given name, <strong>a digital certificate attests that a public key (and its
corresponding private key) is bound to given domain names or IP addresses</strong>.</p><p>When clients connect to a website via HTTPS, the server present its certificate.
The client verifies that the certificate contains the domain name it is
connecting to, and that it was issued by a CA it trusts. The server also sends a
message signed using its private key. The client can then verify the signature
using the public key from the certificate. The assumptions are that:</p><ul><li>The private key to sign the message (which is tied to the public key in the
certificate) is only known to the server serving the specific domain.</li><li>The CA did their due diligence when issuing the certificate to verify that the
requester controls the included domain names.</li></ul><p>It is worth pointing out that <strong>certificates issued by private CAs are
<ins>not</ins> inherently less secure than certificates issued by publicly
trusted CAs</strong>. Both use the same underlying technology and cryptographic
algorithms.</p><p>Private CAs <strong>may</strong> perform less rigorous validations, and their private keys
<strong>may</strong> have fewer protections, like the library membership or retail store
fidelity cards. But it is totally feasible to operate private CAs in a very
secure manner, like it is done with employee badges.</p><h1 id=anatomy-of-a-certificate>Anatomy of a Certificate
<a class=anchor href=#anatomy-of-a-certificate>#</a></h1><p>The format of X.509 digital certificates is detailed in
<a href=https://datatracker.ietf.org/doc/html/rfc5280>RFC 5280</a>. A certificate is made
of a sequence of 3 fields:</p><ul><li>The
<a href=https://datatracker.ietf.org/doc/html/rfc5280#section-4.1.1.1>tbsCertificate</a>
is the data structure representing the certificate to be signed (tbs).</li><li>The
<a href=https://datatracker.ietf.org/doc/html/rfc5280#section-4.1.1.2>signatureAlgorithm</a>
identifies/defines how the <code>signatureValue</code> is computed.</li><li>The
<a href=https://datatracker.ietf.org/doc/html/rfc5280#section-4.1.1.3>signatureValue</a>
is the digital signature computed upon the <code>tbsCertificate</code> using
<code>signatureAlgorithm</code>.</li></ul><p>This section only covers the <code>tbsCertificate</code> data structure of publicly trusted
DV (Domain Validated) TLS web server leaf/end-entity certificates.</p><details><summary>Click here to view the example certificate being dissected.</summary><div class=markdown-inner><p>We are only going to look at the content of the <code>Data:</code> field, which corresponds
to the <code>tbsCertificate</code>.</p><pre tabindex=0><code>Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number:
            02:71:83:d4:a8:25:79:07:0a:3d:8f:60:9e:27:cd:e5
        Signature Algorithm: ecdsa-with-SHA256
        Issuer: C = US, O = Google Trust Services, CN = WE2
        Validity
            Not Before: Mar 31 08:56:27 2025 GMT
            Not After : Jun 23 08:56:26 2025 GMT
        Subject: CN = www.google.com
        Subject Public Key Info:
            Public Key Algorithm: id-ecPublicKey
                Public-Key: (256 bit)
                pub:
                    04:11:e3:07:97:e4:71:0c:5f:61:38:c3:56:6b:cc:
                    e0:9a:6b:e1:18:63:2f:e9:87:e3:2c:a4:f2:54:ef:
                    a1:d5:fd:06:c1:70:4c:cc:1b:69:9d:c0:1f:ba:cf:
                    7f:d3:ef:ea:cd:ef:33:d0:81:19:67:30:0e:45:59:
                    6c:35:d2:e0:d4
                ASN1 OID: prime256v1
                NIST CURVE: P-256
        X509v3 extensions:
            X509v3 Key Usage: critical
                Digital Signature
            X509v3 Extended Key Usage:
                TLS Web Server Authentication
            X509v3 Basic Constraints: critical
                CA:FALSE
            X509v3 Subject Key Identifier:
                DC:A3:F6:5E:4C:F2:71:46:51:A4:50:98:91:8B:FC:20:EF:29:70:45
            X509v3 Authority Key Identifier:
                75:BE:C4:77:AE:89:F6:44:37:7D:CF:B1:68:1F:1D:1A:EB:DC:34:59
            Authority Information Access:
                OCSP - URI:http://o.pki.goog/we2
                CA Issuers - URI:http://i.pki.goog/we2.crt
            X509v3 Subject Alternative Name:
                DNS:www.google.com
            X509v3 Certificate Policies:
                Policy: 2.23.140.1.2.1
            X509v3 CRL Distribution Points:
                Full Name:
                  URI:http://c.pki.goog/we2/xuzt3PU9F_w.crl
            CT Precertificate SCTs:
                Signed Certificate Timestamp:
                    Version   : v1 (0x0)
                    Log ID    : CF:11:56:EE:D5:2E:7C:AF:F3:87:5B:D9:69:2E:9B:E9:
                                1A:71:67:4A:B0:17:EC:AC:01:D2:5B:77:CE:CC:3B:08
                    Timestamp : Mar 31 09:56:28.830 2025 GMT
                    Extensions: none
                    Signature : ecdsa-with-SHA256
                                30:45:02:21:00:C7:F7:8F:00:6E:B4:79:C5:9C:7A:35:
                                69:4C:7D:7B:E1:1B:36:C8:0F:D9:6C:C2:63:28:4C:DE:
                                8F:47:D7:72:74:02:20:20:2D:9B:F5:90:5B:74:A6:8D:
                                3B:B6:99:65:3A:F9:3F:2C:0C:F1:F1:1B:4E:F6:5D:C8:
                                0C:7C:6C:D2:AE:C0:5D
                Signed Certificate Timestamp:
                    Version   : v1 (0x0)
                    Log ID    : A2:E3:0A:E4:45:EF:BD:AD:9B:7E:38:ED:47:67:77:53:
                                D7:82:5B:84:94:D7:2B:5E:1B:2C:C4:B9:50:A4:47:E7
                    Timestamp : Mar 31 09:56:29.795 2025 GMT
                    Extensions: none
                    Signature : ecdsa-with-SHA256
                                30:46:02:21:00:8B:BB:DB:F5:A1:0F:EF:2D:CA:E0:57:
                                63:22:7B:B2:A5:21:4D:7B:AE:AE:CE:0C:2C:92:2A:0D:
                                C4:F6:63:A5:12:02:21:00:D0:39:B3:EF:C0:29:FA:03:
                                DB:9D:48:49:F9:48:9F:C5:1F:23:43:6B:41:5F:B2:76:
                                EF:07:C7:EA:C6:DF:97:76
    Signature Algorithm: ecdsa-with-SHA256
    Signature Value:
        30:44:02:20:64:e4:a1:aa:cf:67:8d:77:b3:e5:67:a7:fd:bb:
        aa:65:62:99:b1:7c:39:ec:13:e2:75:2a:23:1d:42:79:22:1a:
        02:20:24:5d:e6:e0:84:18:0a:73:47:9b:06:e7:4e:80:9d:5b:
        30:ac:f2:9d:32:d8:97:1f:b4:6a:74:e1:a2:c5:b5:ee
-----BEGIN CERTIFICATE-----
MIIDlTCCAzygAwIBAgIQAnGD1KgleQcKPY9gnifN5TAKBggqhkjOPQQDAjA7MQsw
CQYDVQQGEwJVUzEeMBwGA1UEChMVR29vZ2xlIFRydXN0IFNlcnZpY2VzMQwwCgYD
VQQDEwNXRTIwHhcNMjUwMzMxMDg1NjI3WhcNMjUwNjIzMDg1NjI2WjAZMRcwFQYD
VQQDEw53d3cuZ29vZ2xlLmNvbTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABBHj
B5fkcQxfYTjDVmvM4Jpr4RhjL+mH4yyk8lTvodX9BsFwTMwbaZ3AH7rPf9Pv6s3v
M9CBGWcwDkVZbDXS4NSjggJCMIICPjAOBgNVHQ8BAf8EBAMCB4AwEwYDVR0lBAww
CgYIKwYBBQUHAwEwDAYDVR0TAQH/BAIwADAdBgNVHQ4EFgQU3KP2XkzycUZRpFCY
kYv8IO8pcEUwHwYDVR0jBBgwFoAUdb7Ed66J9kQ3fc+xaB8dGuvcNFkwWAYIKwYB
BQUHAQEETDBKMCEGCCsGAQUFBzABhhVodHRwOi8vby5wa2kuZ29vZy93ZTIwJQYI
KwYBBQUHMAKGGWh0dHA6Ly9pLnBraS5nb29nL3dlMi5jcnQwGQYDVR0RBBIwEIIO
d3d3Lmdvb2dsZS5jb20wEwYDVR0gBAwwCjAIBgZngQwBAgEwNgYDVR0fBC8wLTAr
oCmgJ4YlaHR0cDovL2MucGtpLmdvb2cvd2UyL3h1enQzUFU5Rl93LmNybDCCAQUG
CisGAQQB1nkCBAIEgfYEgfMA8QB2AM8RVu7VLnyv84db2Wkum+kacWdKsBfsrAHS
W3fOzDsIAAABleuhkB4AAAQDAEcwRQIhAMf3jwButHnFnHo1aUx9e+EbNsgP2WzC
YyhM3o9H13J0AiAgLZv1kFt0po07tpllOvk/LAzx8RtO9l3IDHxs0q7AXQB3AKLj
CuRF772tm3447Udnd1PXgluElNcrXhssxLlQpEfnAAABleuhk+MAAAQDAEgwRgIh
AIu72/WhD+8tyuBXYyJ7sqUhTXuurs4MLJIqDcT2Y6USAiEA0Dmz78Ap+gPbnUhJ
+UifxR8jQ2tBX7J27wfH6sbfl3YwCgYIKoZIzj0EAwIDRwAwRAIgZOShqs9njXez
5Wen/buqZWKZsXw57BPidSojHUJ5IhoCICRd5uCEGApzR5sG506AnVswrPKdMtiX
H7RqdOGixbXu
-----END CERTIFICATE-----
</code></pre></div></details><h2 id=version>Version
<a class=anchor href=#version>#</a></h2><pre tabindex=0><code>        Version: 3 (0x2)
</code></pre><p>All digital certificates use the X.509 version 3. The key addition to X.509
version 3 is the support for extensions. Version 3 was standardized in 1999 in
<a href=https://datatracker.ietf.org/doc/html/rfc2459#section-3.1>RFC 2459</a>, which is
the precursor of RFC 5280.</p><h2 id=serial-number>Serial Number
<a class=anchor href=#serial-number>#</a></h2><pre tabindex=0><code>        Serial Number:
            02:71:83:d4:a8:25:79:07:0a:3d:8f:60:9e:27:cd:e5
</code></pre><p>The serial number uniquely identifies the certificate. CRLs (Certificate
Revocation Lists) reference revoked certificates by serial number. Serial
numbers are unique across all certificates issued by a CA.</p><h2 id=signature-algorithm>Signature Algorithm
<a class=anchor href=#signature-algorithm>#</a></h2><pre tabindex=0><code>        Signature Algorithm: ecdsa-with-SHA256
</code></pre><p>The inner signature algorithm in the <code>tbsCertificate</code> data structure has the
same value as the outer one. The inner signature algorithm is part of the signed
data (to guarantee its integrity), while the outer one isn&rsquo;t. When decoding a
certificate, the signature of the raw <code>tbsCertificate</code> is verified before
decoding it. This is why the signature algorithm must also be set outside of the
<code>tbsCertifiate</code>.</p><h2 id=issuer>Issuer
<a class=anchor href=#issuer>#</a></h2><pre tabindex=0><code>        Issuer: C = US, O = Google Trust Services, CN = WE2
</code></pre><p>The issuer holds the value of the subject field of the issuing CA certificate.
It is used to Facilitate the construction of the certificate chain.</p><p>The following command downloads the issuing CA certificate and extracts its
subject field.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -s http://i.pki.goog/we2.crt | openssl x509 -inform DER -noout -subject
</span></span><span style=display:flex><span>subject<span style=color:#f92672>=</span>C <span style=color:#f92672>=</span> US, O <span style=color:#f92672>=</span> Google Trust Services, CN <span style=color:#f92672>=</span> WE2
</span></span></code></pre></div><h2 id=validity>Validity
<a class=anchor href=#validity>#</a></h2><pre tabindex=0><code>        Validity
            Not Before: Mar 31 08:56:27 2025 GMT
            Not After : Jun 23 08:56:26 2025 GMT
</code></pre><p>The validity defines the timestamps between which the certificate is valid. The
<code>notBefore</code> timestamp is usually backdated by a few minutes to ensure the
certificate is recognized as immediately valid, even by machines not having an
accurate clock. Refer to
<a href=/webpki/cert-lifetime>the page dedicated to certificate validities</a> for more
information.</p><h2 id=subject>Subject
<a class=anchor href=#subject>#</a></h2><pre tabindex=0><code>        Subject: CN = www.google.com
</code></pre><p>The subject is a is made of a sequence of key-value pairs. <code>CN</code> stands for
<code>commonName</code>. This is where the domain name was <strong>historically</strong> set. <strong>The
subject field is long deprecated for DV TLS web server leaf certificates</strong>.
Nowadays, domain names are set in the <code>Subject Alternative Name</code> extension.</p><p>Modern clients should ignore the subject field of DV TLS web server leaf
certificates. Some CAs still set it to ensure that very outdated clients (not
aware that the <code>Subject Alternative Name</code> should be used instead) are still able
to process the certificate.</p><p>OV (Organization Validated), EV (Extended Validation) and QWAC (Qualified Web
Authentication Certificate) certificates set additional key-value pairs in the
subject field, like for example <code>C=</code> (<code>countryName</code>) or <code>O=</code>
(<code>organizationName</code>).</p><h2 id=subject-public-key-info>Subject Public Key Info
<a class=anchor href=#subject-public-key-info>#</a></h2><pre tabindex=0><code>        Subject Public Key Info:
            Public Key Algorithm: id-ecPublicKey
                Public-Key: (256 bit)
                pub:
                    04:11:e3:07:97:e4:71:0c:5f:61:38:c3:56:6b:cc:
                    e0:9a:6b:e1:18:63:2f:e9:87:e3:2c:a4:f2:54:ef:
                    a1:d5:fd:06:c1:70:4c:cc:1b:69:9d:c0:1f:ba:cf:
                    7f:d3:ef:ea:cd:ef:33:d0:81:19:67:30:0e:45:59:
                    6c:35:d2:e0:d4
                ASN1 OID: prime256v1
                NIST CURVE: P-256
</code></pre><p>The subject public key info carries the public key and identifies the algorithm
with which the key is used.</p><h2 id=extensions>Extensions
<a class=anchor href=#extensions>#</a></h2><p>Extensions may be marked as <strong>critical</strong>. Critical extensions must be processed
by clients. Clients must refuse certificates having critical extensions they do
not recognize.</p><h3 id=key-usage>Key Usage
<a class=anchor href=#key-usage>#</a></h3><pre tabindex=0><code>            X509v3 Key Usage: critical
                Digital Signature
</code></pre><p>The key usage extension defines the purpose of the key. The public key in the
certificate is only used to verify signatures made using its corresponding
private key. This is why &ldquo;Digital Signature&rdquo; is the only purpose of the key.</p><h3 id=eku>Extended Key Usage
<a class=anchor href=#eku>#</a></h3><pre tabindex=0><code>            X509v3 Extended Key Usage:
                TLS Web Server Authentication
</code></pre><p>The extended key usage extension indicates the purposes for which the
certificate may be used. For website certificates, &ldquo;TLS Web Server
Authentication&rdquo; (<code>id-kp-serverAuth</code>) must be set.</p><h3 id=basic-constraints>Basic Constraints
<a class=anchor href=#basic-constraints>#</a></h3><pre tabindex=0><code>            X509v3 Basic Constraints: critical
                CA:FALSE
</code></pre><p>The basic constraints extension indicates whether the certificate is a CA
certificate. In a perfect world, this extensions shouldn&rsquo;t need to be explicitly
set to <code>CA:FALSE</code> in leaf certificates since this is the default value.</p><p>But, as demonstrated in
<a href=https://www.blackhat.com/presentations/bh-dc-09/Marlinspike/BlackHat-DC-09-Marlinspike-Defeating-SSL.pdf>this BlackHat talk from 2009</a>,
some clients may not validate certificate chains properly, so some CAs prefer to
keep this extension to avoid introducing very nasty vulnerabilities in such
clients.</p><h3 id=subject-key-identifier>Subject Key Identifier
<a class=anchor href=#subject-key-identifier>#</a></h3><pre tabindex=0><code>            X509v3 Subject Key Identifier:
                DC:A3:F6:5E:4C:F2:71:46:51:A4:50:98:91:8B:FC:20:EF:29:70:45
</code></pre><p>The subject key identifier extension holds a value derived from the public key,
usually by computing its hash.</p><p>This information is very important in CA certificates because it facilitates the
construction of the certificate chain since all certificates must also include
the &ldquo;authority key identifier&rdquo; extension.</p><p>This extension isn&rsquo;t strictly needed in leaf certificates since it isn&rsquo;t used to
validate the certificate chain. One reason to include it anyway is to easily
find all certificates bound to the same public key.</p><h3 id=authority-key-identifier>Authority Key Identifier
<a class=anchor href=#authority-key-identifier>#</a></h3><pre tabindex=0><code>            X509v3 Authority Key Identifier:
                75:BE:C4:77:AE:89:F6:44:37:7D:CF:B1:68:1F:1D:1A:EB:DC:34:59
</code></pre><p>The authority key identifier extension references the subject key identifier of
the issuing CA certificate. It is used to facilitate the construction of the
certificate chain.</p><p>The following command downloads the issuing CA certificate and extracts its
subject key identifier extension.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -s http://i.pki.goog/we2.crt | openssl x509 -inform DER -noout -ext subjectKeyIdentifier
</span></span><span style=display:flex><span>X509v3 Subject Key Identifier:
</span></span><span style=display:flex><span>    75:BE:C4:77:AE:89:F6:44:37:7D:CF:B1:68:1F:1D:1A:EB:DC:34:59
</span></span></code></pre></div><h3 id=aia>Authority Information Access
<a class=anchor href=#aia>#</a></h3><pre tabindex=0><code>            Authority Information Access:
                OCSP - URI:http://o.pki.goog/we2
                CA Issuers - URI:http://i.pki.goog/we2.crt
</code></pre><p>The authority information access (AIA) extension indicates how to access
information and services for the issuer of the certificate. Here the extension
holds two URLs:</p><ul><li>The
<a href=https://datatracker.ietf.org/doc/html/rfc6960>OCSP (Online Certificate Status Protocol)</a>
URL used to check whether the certificate is revoked. Note that
<a href=https://letsencrypt.org/2024/12/05/ending-ocsp/>OCSP is being deprecated</a>.</li><li>The URL to download the issuing CA certificate. Note that clients should not
rely on it to build the certificate chain since the issuing CA certificate may
have been
<a href=https://scotthelme.co.uk/cross-signing-alternate-trust-paths-how-they-work/>cross-signed</a>.
Instead, websites should serve the full certificate chain to their visitors.</li></ul><h3 id=san>Subject Alternative Name
<a class=anchor href=#san>#</a></h3><pre tabindex=0><code>            X509v3 Subject Alternative Name:
                DNS:www.google.com
</code></pre><p>The subject alternative name (SAN) extension lists all identifiers (domain names
and IP addresses) for which this certificate can be used.</p><h3 id=certificate-policies>Certificate Policies
<a class=anchor href=#certificate-policies>#</a></h3><pre tabindex=0><code>            X509v3 Certificate Policies:
                Policy: 2.23.140.1.2.1
</code></pre><p>The <code>certificatePolicies</code> indicate the policy under which the certificate has
been issued and the purposes for which the certificate may be used. The OID
(Object Identifier) <code>2.23.140.1.2.1</code> signifies
&ldquo;<a href=https://cabforum.org>CA/B Forum</a> DV (Domain Validated) Certificate&rdquo;.</p><h3 id=crl-distribution-points>CRL Distribution Points
<a class=anchor href=#crl-distribution-points>#</a></h3><pre tabindex=0><code>            X509v3 CRL Distribution Points:
                Full Name:
                  URI:http://c.pki.goog/we2/xuzt3PU9F_w.crl
</code></pre><p>The CRL distribution points extension references the URL of the CRL (Certificate
Revocation List) for that certificate. CRLs lists all revoked certificates by a
CA. To limit the file size in case many certificates are revoked, some CAs
partition their CRLs in multiple files.</p><p>If the certificate is revoked, it will appear on the linked CRL file.</p><h3 id=sct>CT Precertificate SCTs
<a class=anchor href=#sct>#</a></h3><pre tabindex=0><code>            CT Precertificate SCTs:
                Signed Certificate Timestamp:
                    Version   : v1 (0x0)
                    Log ID    : CF:11:56:EE:D5:2E:7C:AF:F3:87:5B:D9:69:2E:9B:E9:
                                1A:71:67:4A:B0:17:EC:AC:01:D2:5B:77:CE:CC:3B:08
                    Timestamp : Mar 31 09:56:28.830 2025 GMT
                    Extensions: none
                    Signature : ecdsa-with-SHA256
                                30:45:02:21:00:C7:F7:8F:00:6E:B4:79:C5:9C:7A:35:
                                69:4C:7D:7B:E1:1B:36:C8:0F:D9:6C:C2:63:28:4C:DE:
                                8F:47:D7:72:74:02:20:20:2D:9B:F5:90:5B:74:A6:8D:
                                3B:B6:99:65:3A:F9:3F:2C:0C:F1:F1:1B:4E:F6:5D:C8:
                                0C:7C:6C:D2:AE:C0:5D
                Signed Certificate Timestamp:
                    Version   : v1 (0x0)
                    Log ID    : A2:E3:0A:E4:45:EF:BD:AD:9B:7E:38:ED:47:67:77:53:
                                D7:82:5B:84:94:D7:2B:5E:1B:2C:C4:B9:50:A4:47:E7
                    Timestamp : Mar 31 09:56:29.795 2025 GMT
                    Extensions: none
                    Signature : ecdsa-with-SHA256
                                30:46:02:21:00:8B:BB:DB:F5:A1:0F:EF:2D:CA:E0:57:
                                63:22:7B:B2:A5:21:4D:7B:AE:AE:CE:0C:2C:92:2A:0D:
                                C4:F6:63:A5:12:02:21:00:D0:39:B3:EF:C0:29:FA:03:
                                DB:9D:48:49:F9:48:9F:C5:1F:23:43:6B:41:5F:B2:76:
                                EF:07:C7:EA:C6:DF:97:76
</code></pre><p>SCTs (Signed Certificate Timestamps) are promises from CT (Certificate
Transparency) logs to include the (pre)certificate. These are SCTs from
&ldquo;<code>Google 'Xenon2025h1' log</code>&rdquo; and &ldquo;<code>Let's Encrypt 'Oak2025h1'</code>&rdquo;, respectively. We
can verify that by
<a href="https://gchq.github.io/CyberChef/#recipe=From_Hex%28%27Auto%27%29To_Base64%28%27A-Za-z0-9%2B/%3D%27%29">converting the hex-encoded Log ID to base64</a>
and looking for that &ldquo;<code>log_id</code>&rdquo; in
<a href=https://www.gstatic.com/ct/log_list/v3/log_list.json>https://www.gstatic.com/ct/log_list/v3/log_list.json</a>.</p><p>See <a href=/webpki/ct/>the page dedicated to Certificate Transparency</a> for more
information.</p><h1 id=encoding>Encoding
<a class=anchor href=#encoding>#</a></h1><p>Certificates are
<a href=https://letsencrypt.org/docs/a-warm-welcome-to-asn1-and-der/>ASN.1</a> data
structures. Certificates are generally encoded using either DER (Distinguished
Encoding Rules) or PEM (Privacy-Enhanced Mail).</p><p>DER is an unambiguous (as opposed to BER (Basic Encoding Rules)) binary encoding
format for representing ASN.1 data structures as a sequence of bytes.</p><p>PEM is a text-based encoding format, which is essentially a wrapper around the
DER encoding, making it suitable for transmission in text-based systems (like
email, as its name suggests) and for easy copy-pasting. PEM certificates are
made of:</p><ul><li>A &ldquo;<code>-----BEGIN CERTIFICATE-----</code>&rdquo; header line.</li><li>The DER-encoded certificate data, converted to base64.</li><li>A &ldquo;<code>-----END CERTIFICATE-----</code>&rdquo; footer line.</li></ul><p>You can take the base64 DER-encoded certificate data and decode it using an
ASN.1 decoder such as <a href=https://lapo.it/asn1js/>https://lapo.it/asn1js/</a>
(<a href=https://lapo.it/asn1js/#MIIDlTCCAzygAwIBAgIQAnGD1KgleQcKPY9gnifN5TAKBggqhkjOPQQDAjA7MQswCQYDVQQGEwJVUzEeMBwGA1UEChMVR29vZ2xlIFRydXN0IFNlcnZpY2VzMQwwCgYDVQQDEwNXRTIwHhcNMjUwMzMxMDg1NjI3WhcNMjUwNjIzMDg1NjI2WjAZMRcwFQYDVQQDEw53d3cuZ29vZ2xlLmNvbTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABBHjB5fkcQxfYTjDVmvM4Jpr4RhjL-mH4yyk8lTvodX9BsFwTMwbaZ3AH7rPf9Pv6s3vM9CBGWcwDkVZbDXS4NSjggJCMIICPjAOBgNVHQ8BAf8EBAMCB4AwEwYDVR0lBAwwCgYIKwYBBQUHAwEwDAYDVR0TAQH_BAIwADAdBgNVHQ4EFgQU3KP2XkzycUZRpFCYkYv8IO8pcEUwHwYDVR0jBBgwFoAUdb7Ed66J9kQ3fc-xaB8dGuvcNFkwWAYIKwYBBQUHAQEETDBKMCEGCCsGAQUFBzABhhVodHRwOi8vby5wa2kuZ29vZy93ZTIwJQYIKwYBBQUHMAKGGWh0dHA6Ly9pLnBraS5nb29nL3dlMi5jcnQwGQYDVR0RBBIwEIIOd3d3Lmdvb2dsZS5jb20wEwYDVR0gBAwwCjAIBgZngQwBAgEwNgYDVR0fBC8wLTAroCmgJ4YlaHR0cDovL2MucGtpLmdvb2cvd2UyL3h1enQzUFU5Rl93LmNybDCCAQUGCisGAQQB1nkCBAIEgfYEgfMA8QB2AM8RVu7VLnyv84db2Wkum-kacWdKsBfsrAHSW3fOzDsIAAABleuhkB4AAAQDAEcwRQIhAMf3jwButHnFnHo1aUx9e-EbNsgP2WzCYyhM3o9H13J0AiAgLZv1kFt0po07tpllOvk_LAzx8RtO9l3IDHxs0q7AXQB3AKLjCuRF772tm3447Udnd1PXgluElNcrXhssxLlQpEfnAAABleuhk-MAAAQDAEgwRgIhAIu72_WhD-8tyuBXYyJ7sqUhTXuurs4MLJIqDcT2Y6USAiEA0Dmz78Ap-gPbnUhJ-UifxR8jQ2tBX7J27wfH6sbfl3YwCgYIKoZIzj0EAwIDRwAwRAIgZOShqs9njXez5Wen_buqZWKZsXw57BPidSojHUJ5IhoCICRd5uCEGApzR5sG506AnVswrPKdMtiXH7RqdOGixbXu>example</a>).</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script><i><a href=https://acmeprotocol.dev/>acmeprotocol.dev</a> is a side project from <a href=https://www.linkedin.com/in/fhchstr/>Fabien Hochstrasser</a>. The opinions expressed on this website are my own and do not reflect the views of my current or former employers.</i></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#analogy-with-the-physical-world>Analogy with the Physical World</a></li><li><a href=#anatomy-of-a-certificate>Anatomy of a Certificate</a><ul><li><a href=#version>Version</a></li><li><a href=#serial-number>Serial Number</a></li><li><a href=#signature-algorithm>Signature Algorithm</a></li><li><a href=#issuer>Issuer</a></li><li><a href=#validity>Validity</a></li><li><a href=#subject>Subject</a></li><li><a href=#subject-public-key-info>Subject Public Key Info</a></li><li><a href=#extensions>Extensions</a><ul><li><a href=#key-usage>Key Usage</a></li><li><a href=#eku>Extended Key Usage</a></li><li><a href=#basic-constraints>Basic Constraints</a></li><li><a href=#subject-key-identifier>Subject Key Identifier</a></li><li><a href=#authority-key-identifier>Authority Key Identifier</a></li><li><a href=#aia>Authority Information Access</a></li><li><a href=#san>Subject Alternative Name</a></li><li><a href=#certificate-policies>Certificate Policies</a></li><li><a href=#crl-distribution-points>CRL Distribution Points</a></li><li><a href=#sct>CT Precertificate SCTs</a></li></ul></li></ul></li><li><a href=#encoding>Encoding</a></li></ul></nav></div></aside></main></body></html>